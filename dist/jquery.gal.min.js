var libs=function(){return{deepExt:function(a){for(var b in a)"object"==typeof a[b]?(this[b]||(this[b]={}),libs.deepExt.apply(this[b],[a[b]])):this[b]=a[b]},addToSessionStorage:function(a,b){var c=null===sessionStorage.getItem(a)?[]:sessionStorage.getItem(a);c+=b+";",sessionStorage.setItem(a,c)},removeFromLocalStorage:function(a,b){var c=null===sessionStorage.getItem(a)?[]:sessionStorage.getItem(a),d=c.split(";");d.splice(b,1),sessionStorage.setItem(a,d.join(";"))}}}();function isOverTheList(a,b){"use strict";return a.pageX>=b.offset().left+parseInt(b.css("padding-left"),10)&&a.pageX<=b.offset().left+parseInt(b.css("width"),10)+parseInt(b.css("padding-left"),10)&&a.pageY>=b.offset().top&&a.pageY<=b.offset().top+parseInt(b.css("height"),10)}(function(a){"use strict";a.fn.gal=function(b){let c={},d=this,e=null,f=null;libs.deepExt.apply(c,[a.fn.gal.defaults]),libs.deepExt.apply(c,[b]),sessionStorage.removeItem("imgList");for(let c=0;c<b.nrOfImgs;c++)e=a("<img />"),e.attr("src",b.imagesDir+"0"+(c+1)+".jpg"),this.append(e),e=null;this.children("img").wrap("<div></div>"),this.addClass("gal_scene"),this.find("div>img").addClass("gal_img");let g=a("<img />").attr({src:"img/gal_close.png",width:"25px"}).data({gal_close:!0}).addClass("gal_close"),h=a("<img />").attr({src:"img/gal_maximize.png",width:"30px",class:"gal_maximize"}),i=a("<img />").attr({src:"img/gal_left.png",width:"30px",class:"gal_left"}),j=a("<img />").attr({src:"img/gal_right.png",width:"30px",class:"gal_right"}),k=a("div.gal_scene").find("div"),l=a("ul#gal_list"),m=a(".gal_enlarged"),n=a("<div class=\"gal_topEnlarged\"></div>").on("mousedown",function(b){a(this).data("msdown",!0).data("position",{X:b.pageX,Y:b.pageY})}).on("mouseup",function(b){if(a(this).data("msdown",!1),isOverTheList(b,l)){let b=a(this).parent().find(".gal_img").attr("src"),c=a("<li></li>"),d=a("<button class=\"gal_button\"/>").on("click",function(){a(this).parent().animate({opacity:"0",width:"0px"},500,function(){libs.removeFromLocalStorage("imgList",a(this).index()),a(this).remove()})});d.html("remove"),c.html(b);let e=a("<img />").attr("src",b);e.attr("width","80px"),c.append(e),c.append(d),l.append(c),libs.addToSessionStorage("imgList",b),g.trigger("click"),m.css({"background-color":"transparent"}).animate({left:l.offset().left+"px",top:l.offset().top+"px",width:l.css("width")},()=>{g.trigger("click")})}});a("body").on("mousemove",b=>{if(n.data("msdown")){let c=b.pageX-n.data("position").X,d=b.pageY-n.data("position").Y;n.data("position",{X:b.pageX,Y:b.pageY}),a(".gal_enlarged").css({left:"+="+c,top:"+="+d}),b.pageY>window.innerHeight-50&&l[0].scrollIntoView({behavior:"smooth"})}b.stopPropagation(),b.bubbles=!1});let o=k.length,p=parseInt(d.css("width"),10),q=5<o?140:parseInt(p/o,10)-10;return a("img.gal_img").css({opacity:c.mouseOut.opacity}),f=!1,k.children("img").css({width:`${q-10}px`}).on("mouseover",function(){a(this).animate({opacity:1},500)}).on("mouseout",function(){a(this).animate({opacity:c.mouseoutOpacity},500)}),k.addClass("gal_button").css({width:q}).on("click",function(){if(f)return;f=!0;let b=a(this),e=a(this).html();a(this).fadeTo(500,.3).clone().empty().css({width:"0px",height:"0px","background-color":c.openProp["background-color"],left:parseInt(d.css("width"),10)/2-6+"px"}).appendTo(d).addClass("gal_enlarged").addClass("gal_clearfix").animate({width:"400px",height:"240px",left:`50px`,top:`${window.pageYOffset+30}px`},c.openProp.speed,function(){a(this).html(e).fadeTo(0,0).fadeTo(500,1,function(){let b=a(this).find(".gal_img");b.data("scale","1"),b.data("left","0"),b.data("top","0"),a(this).css({"background-color":"transparent"}).children("img.gal_img").wrap("<div class=\"gal_imgWrapper\"></div>").css({opacity:1}).on("click",a=>{b.css({cursor:"zoom-in"});let c=parseInt(b.data("scale")),d=parseInt(b.data("left")),e=parseInt(b.data("top"));c*=1.5;let f=a.clientX,g=a.clientY;return 40>f?(d+=10,b.data("left",d),void b.css({transform:`translate(${d}px,${e}px)`,transition:"all .2s ease-in"})):80>g?(e+=10,b.data("top",e),void b.css({transform:`translate(${d}px,${e}px)`,transition:"all .2s ease-in"})):void(5<c&&(c=5),b.data("scale",1.5*c),b.css({transform:`scale(${c}) translate(${.2*-f}px,${.2*-g}px)`,transition:"all .5s ease-in"}))}).on("contextmenu",a=>{b.css({cursor:"zoom-out"});let c=.67*parseInt(b.data("scale"));1>c&&(c=1),b.data("scale",c),b.css({transform:`scale(${c})`}),a.preventDefault()})}).prepend(n).prepend(i).on("click",function(c){if(a(c.target).hasClass("gal_left")){let c=b.prev();if(c!==b){let d=c.children("img").attr("src");void 0!==d&&(a(this).find("img.gal_img").attr("src",d),b=c)}}}).prepend(j).on("click",function(c){if(a(c.target).hasClass("gal_right")){let c=b.next();if(!c.hasClass("gal_enlarged")){let d=c.children("img.gal_img").attr("src");void 0!==d&&(a(this).find("img.gal_img").attr("src",d),b=c)}}}).prepend(h).prepend(g).on("click",function(c){return!!a(c.target).hasClass("gal_close")&&(c.bubbles=!1,a(this).fadeOut(500),b.fadeTo(500,1),f=!1,c.stopPropagation(),!1)}).children("img.gal_img").css({width:"100%"})}).children(".gal_leftButton").css({color:"red",height:parseInt(a(".gal_enlarged").find("img:eq(3)").css("height"),10)+"px"})}),h.on("click",()=>{0<a(this).find(".gal_maximize")[0].src.indexOf("maximize")?(a(".gal_enlarged").animate({width:"98vw",height:"100%",left:"0px"}),a(this).find(".gal_maximize")[0].src="img/gal_minimize.png"):(a(".gal_enlarged").animate({width:"400px",height:"240px",left:"40px"}),a(this).find(".gal_maximize")[0].src="img/gal_maximize.png")}),this},a.fn.gal.defaults={enlarge:a.fn.fadeTo,openSpeed:500,openbg:"#777777",mouseoutOpacity:.7,mouseOut:{opacity:.7},openProp:{speed:500,css:{opacity:.7},"background-color":"#777777"}}})(jQuery);